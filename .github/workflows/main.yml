# This is a basic workflow to help you get started with Actions

# Controls when the workflow will run
on:
  workflow_dispatch:
    inputs:
      version_name:
        # i.e. v3.0.0, v7.39.0-rc1
        description: 'Version of the release candidate build (RC)'
        required: true
      release_thread_id:
        description: 'ID of the release discussion thread on the repo'
        required: true
        

name: RC Release

jobs:
  build:
    name: RC Release
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Create Branch
        # You may pin to the exact commit or the version.
        # uses: peterjgrainger/action-create-branch@b48b0ca0e307c9b56f059b70274984ffeaa90a43
        uses: peterjgrainger/action-create-branch@v2.0.1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # This token is provided by Actions, you do not need to create your own token
        with:
          # The branch to create
          branch: release/${{ github.event.inputs.version_name }}
      - name: Create Release
        id: create_release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # This token is provided by Actions, you do not need to create your own token
        with:
          repository: release/${{ github.event.inputs.version_name }}
          tag_name: ${{ github.ref }}
          release_name: v${{ github.event.inputs.version_name }}
          body: |
            Release notes
            {link from confluence note}
            
            Release thread
            https://github.com/MoneyLion/mobile-app/discussions/${{ github.event.inputs.release_thread_id }}
          draft: true
          prerelease: false
